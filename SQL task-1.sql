SQL Task-1 (15/09/2021)
create table regions(region_id int not null primary key,region_name varchar(50));
create table countries(country_id varchar(20) not null primary key,country_name varchar(50),region_id int not null);
create table locations(location_id int primary key,street_address varchar(50),postal_code varchar(20) ,city varchar(50) not null,state_province varchar(50),country_id varchar(20) not null);
create table departments(dept_id int not null primary key,dept_name varchar(50) not null,manger_id int,location_id int not null);
create table jobs(job_id varchar(20) not null primary key,job_title varchar(50) not null,min_salary decimal ,max_salary decimal) ;
create table emplyoees(emp_id int not null primary key,first_name varchar(50) not null,last_name varchar(50) not null,email varchar(50) not null,phone_no varchar(20),hire_date date not null,job_id varchar(20) not null,salary decimal not null,commision decimal,manager_id int,dept_id int);
create table job_history(emp_id int not null,start_date date not null,end_date date not null,job_id varchar(20) not null,dept_id int not null);
alter table locations modify column location_id int auto_increment ;
alter table job_history modify column emp_id int primary key;
alter table job_history modify column start_date date primary key;
insert into regions values(1,'india') ;
insert into regions values(2,'europe') ;
insert into regions values(3,'usa') ;
insert into regions values(4,'austrelia') ;
insert into regions values(5,'africa') ;
select * from regions;
alter table countries add foreign key (region_id) references regions(region_id);
alter table locations add foreign key(country_id) references countries(country_id);
alter table departments add foreign key(location_id) references locations(location_id);
alter table emplyoees add foreign key(job_id) references jobs(job_id);
alter table emplyoees add foreign key(dept_id) references departments(dept_id);
alter table job_history add foreign key(job_id) references jobs(job_id);
alter table job_history add foreign key(dept_id) references departments(dept_id);
insert into countries values("ind01","india",1);
insert into countries values("eng02","england",2);
insert into countries values("usa03","usa",3);
insert into countries values("bri04","briten",2);
insert into countries values("saf05","southafrica",5);
select * from countries;
insert into countries values("aus06","austrelia",4);
insert into locations values(1001,"28 bangalore","4356","bangalore","karntaka","ind01");
select * from locations;
insert into locations values(1002,"08 manchaster","7866","england","england","eng02");
insert into locations values(1003,"76 newyork","1245","Newyork","usa","usa03");
insert into locations values(1004,"09 canbera","4356","canbera","australia","aus06");
insert into locations values(1005,"76 capetown","6986","capetown","southafrica","saf05");
select * from locations;
insert into departments values(10,"administration",201,1002);
insert into departments values(11,"training",211,1001);
insert into departments values(12,"sales",221,1003);
insert into departments values(13,"testing",231,1005);
insert into departments values(14,"development",241,1004);
insert into jobs values("TR_DEV","Trainee development",20000,40000);
insert into jobs values("H_SA","Head sales",20000,60000);
insert into jobs values("TEST","Testing",10000,40000);
insert into jobs values("TH_AD","Tech head admin",20000,48000);
insert into jobs values("H_TR","Head trainer",15000,45000);
insert into emplyoees values(101,"ram","raj","ramraj","567889","2020-10-09","TR_DEV",23000,null,241,14);
insert into emplyoees values(102,"sham","kumar","shamkumar","987893","2012-01-29","H_TR",40000,null,211,11);
insert into emplyoees values(103,"nikil","kumar","nikilk","564589","2008-06-23","TEST",27000,null,231,13);
insert into emplyoees values(104,"sita","kumari","sitak","587689","2010-10-08","TH_AD",20000,null,201,10);
insert into emplyoees values(105,"rithvik","raj","rithvikraj","987345","2020-11-18","H_SA",43000,8000,221,12);
insert into job_history values(102,"2012-01-29","2020-12-30","H_TR",11);
insert into job_history values(104,"2010-10-08","2015-05-12","H_TR",10);
insert into job_history values(105,"2020-11-18","2020-12-30","H_SA",12);
insert into job_history values(103,"2010-10-08","2019-06-19","TEST",13);
insert into job_history values(101,"2020-10-09","2020-12-30","TR_DEV",14);
select * from regions;
select * from countries;
select * from locations;
select * from departments;
select * from jobs;
select * from emplyoees;
select * from job_history;
drop table job_history;
create table job_history(emp_id int not null,start_date date not null,end_date date not null,job_id varchar(20) not null,dept_id int not null,primary key(emp_id,start_date));
alter table job_history add foreign key(job_id) references jobs(job_id);
alter table job_history add foreign key(dept_id) references departments(dept_id);
insert into job_history values(102,"2012-01-29","2020-12-30","H_TR",11);
insert into job_history values(104,"2010-10-08","2015-05-12","H_TR",10);
insert into job_history values(105,"2020-11-18","2020-12-30","H_SA",12);
insert into job_history values(103,"2010-10-08","2019-06-19","TEST",13);
insert into job_history values(101,"2020-10-09","2020-12-30","TR_DEV",14);
select * from job_history;
alter table departments add foreign key(manger_id) references departments(manger_id);
insert into emplyoees values(106,"smita","kumari","smitak","587600",str_to_date("12-Apr-2011","%d-%M-%Y"),"TH_AD",20000,null,201,10);
select * from emplyoees;
alter table departments add unique index(manger_id);
alter table departments drop  primary key;
alter table emplyoees drop foreign key manager_id;
commit;
describe departments;
alter table emplyoees add foreign key(manager_id) references departments(manger_id);
desc emplyoees;
desc departments;
commit;
alter table departments add foreign key(manger_id) references emplyoees(manager_id);
desc locations;
alter table departments add constraint departments_idfk_3 foreign key(manger_id) references deaprtments(manger_id);
select dept_name,emp_id,dept_id from departments join emplyoees on departments.manger_id=emplyoees.manager_id;
select * from departments;
alter table countries rename column region_id to region_id1;
alter table locations rename column country_id to country_id1;
alter table departments rename column location_id to location_id1;
alter table emplyoees rename column job_id to job_id1;
alter table emplyoees rename column dept_id to dept_id1;
alter table job_history rename column job_id to job_id2;
alter table job_history rename column dept_id to dept_id2;
select dept_name,emp_id,dept_id from emplyoees join departments on departments.manger_id=emplyoees.manager_id;
alter table job_history rename column emp_id to emp_id1;
select emp_id1,first_name from emplyoees e,job_history jh where e.emp_id=jh.emp_id1;
select country_name from countries order by country_name desc;
select * from countries where country_name="india";
select emp_id,first_name,salary from emplyoees group by emp_id having min(salary)>20000;
select emp_id from emplyoees group by emp_id having count(emp_id)=1;
select max(salary) as highestsalary from (select distinct(salary) from emplyoees order by salary desc) as highsalary;
select * from emplyoees;

